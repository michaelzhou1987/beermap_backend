(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{355:function(e,t,a){"use strict";a.d(t,"a",function(){return l}),a.d(t,"c",function(){return u}),a.d(t,"b",function(){return m}),a.d(t,"d",function(){return d});var r=a(70),n=a(72);function o(){var e=Object(r.a)(["\n  query {\n    brewerys {\n      name\n      _id\n    }\n  }\n"]);return o=function(){return e},e}function c(){var e=Object(r.a)(["\n  query beer ($id: ID!){\n    beer (_id:$id) {\n      name\n      _id\n      country\n      state\n      city\n      rate\n      date\n      breweryName\n      description\n    }\n  }\n"]);return c=function(){return e},e}function s(){var e=Object(r.a)(["\n  query {\n    beers {\n      name\n      _id\n      country\n      state\n      city\n      rate\n      date\n      breweryName\n      description\n    }\n  }\n"]);return s=function(){return e},e}function i(){var e=Object(r.a)(["\n  query existingUser($email: String!) {\n    existingUser(email: $email) {\n      email\n      _id\n    }\n  }\n"]);return i=function(){return e},e}var l=Object(n.a)(i()),u=Object(n.a)(s()),m=Object(n.a)(c()),d=Object(n.a)(o())},396:function(e,t,a){},404:function(e,t,a){"use strict";a.r(t);var r=a(400),n=a(73),o=a.n(n),c=a(91),s=a(59),i=a(60),l=a(62),u=a(61),m=a(63),d=a(0),y=a.n(d),p=a(357),f=a.n(p),h=(a(396),a(41)),b=a(406),g=a(399),v=a(348),E=a(355),w=a(92),C=a(64),N=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).addBeer=Object(c.a)(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.CREATE_BEER({variables:{beerInput:{name:a.state.name,brewery:a.state.breweryId,breweryName:a.state.breweryName,rate:a.state.rate,date:a.state.date,country:a.state.beerCountry,state:a.state.beerState,city:a.state.beerCity,description:a.state.description}},refetchQueries:[{query:E.c}]});case 2:if(e.sent.data.createBeer){e.next=6;break}return window.alert("not able to create"),e.abrupt("return");case 6:a.props.history.push("/beers");case 7:case"end":return e.stop()}},e)})),a.findByCode=function(e,t){var a=null;return e.forEach(function(e){e.code==t&&(a=e.name)}),a},a.findById=function(e,t){var a=null;return e.forEach(function(e){e._id==t&&(a=e.name)}),a},a.showModal=function(){a.setState({visible:!0})},a.handleOk=function(e){console.log(e),console.log(a.state),""!==a.state.breweryName.trim()&&(a.props.CREATE_BREWERY({variables:{breweryInput:{name:a.state.breweryName,country:a.state.breweryCountry,state:a.state.breweryState,city:a.state.breweryCity}},refetchQueries:[{query:E.d}]}),a.setState({visible:!1}))},a.handleCancel=function(e){console.log(e),a.setState({visible:!1})},a.state={country:[],state:[],city:[],errorMsg:"",rate:0,visible:!1,breweryId:"",breweryName:"",breweryCountry:"",breweryState:"",breweryCity:"",beerCountry:"",beerState:"",beerCity:"",date:"",description:"",name:""},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"getCountryData",value:function(){var e=Object(c.a)(o.a.mark(function e(){var t,a,n,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({errorMsg:""}),e.next=3,f.a.get("http://api.geonames.org/countryInfoJSON?username=michaelzhou1987");case 3:t=e.sent,(a=t.data.geonames.map(function(e){return{name:e.countryName,code:e.geonameId}})).sort(function(e,t){return e.name<t.name?-1:1}),n=0;case 7:if(!(n<a.length)){e.next=15;break}if("6252001"!=a[n].code){e.next=12;break}return c=a.splice(n,1),a.unshift.apply(a,Object(r.a)(c)),e.abrupt("break",15);case 12:n++,e.next=7;break;case 15:this.setState({country:a});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getStateInfo",value:function(){var e=Object(c.a)(o.a.mark(function e(t){var a,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({errorMsg:""}),e.next=3,f.a.get("http://api.geonames.org/childrenJSON?geonameId=".concat(t,"&username=michaelzhou1987"));case 3:if((a=e.sent).data.geonames){e.next=7;break}return this.setState({errorMsg:a.data.message}),e.abrupt("return");case 7:r=a.data.geonames.map(function(e){return{name:e.name,code:e.geonameId}}),this.setState({state:r});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getCityInfo",value:function(){var e=Object(c.a)(o.a.mark(function e(t){var a,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({errorMsg:""}),e.next=3,f.a.get("http://api.geonames.org/childrenJSON?geonameId=".concat(t,"&username=michaelzhou1987"));case 3:if((a=e.sent).data.geonames){e.next=7;break}return this.setState({errorMsg:a.data.message}),e.abrupt("return");case 7:r=a.data.geonames.map(function(e){return{name:e.name,code:e.geonameId}}),this.setState({city:r});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return y.a.createElement("div",{className:"add-beer-page-wrapper"},y.a.createElement("h3",null,"Add a new beer"),y.a.createElement("form",{action:"/",method:"post",className:"container form-wrapper",onSubmit:function(e){e.preventDefault()}},y.a.createElement("div",{className:"form-group"},y.a.createElement("p",{className:"error-message"},this.state.errorMsg)),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"inputName"},"Name of the beer"),y.a.createElement("input",{type:"text",className:"form-control",id:"inputName",placeholder:"Name of the beer",defaultValue:this.state.name,onChange:function(t){e.setState({name:t.target.value})}})),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"inputBrewery"},"Brewery"),y.a.createElement("select",{id:"inputBrewery",className:"form-control",onChange:function(t){var a=e.findById(e.props.getBreweryQuery.brewerys,t.target.value);e.setState({breweryId:t.target.value,breweryName:a})}},y.a.createElement("option",{defaultValue:!0},"Please choose..."),this.props.getBreweryQuery.brewerys&&this.props.getBreweryQuery.brewerys.length>0?this.props.getBreweryQuery.brewerys.map(function(e){return y.a.createElement("option",{value:e._id,key:e._id},e.name)}):null),y.a.createElement(h.a,{type:"link",onClick:this.showModal},"Add a new brewery")),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"inputBreweryName"},"Brewery Name"),y.a.createElement("input",{type:"text",className:"form-control",id:"inputBreweryName",placeholder:"input brewery name...",defaultValue:this.state.breweryName})),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"inputDate"},"Date"),y.a.createElement(b.a,{className:"form-control isAntd",onChange:function(t,a){e.setState({date:a})}})),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"inputCountry"},"Country"),y.a.createElement("select",{id:"inputCountry",className:"form-control",onChange:function(t){var a=e.findByCode(e.state.country,t.target.value);e.getStateInfo(t.target.value),e.setState({beerCountry:a})}},y.a.createElement("option",{defaultValue:!0},"Please choose..."),this.state.country.length>0?this.state.country.map(function(e){return y.a.createElement("option",{value:e.code,key:e.code},e.name)}):null)),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"inputState"},"State"),y.a.createElement("select",{id:"inputState",className:"form-control",onChange:function(t){var a=e.findByCode(e.state.state,t.target.value);e.getCityInfo(t.target.value),e.setState({beerState:a})}},y.a.createElement("option",{defaultValue:!0},"Please choose..."),this.state.state.length>0?this.state.state.map(function(e){return y.a.createElement("option",{value:e.code,key:e.code},e.name)}):null)),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"inputCity"},"City"),y.a.createElement("select",{id:"inputCity",className:"form-control",onChange:function(t){var a=e.findByCode(e.state.city,t.target.value);e.setState({beerCity:a})}},y.a.createElement("option",{defaultValue:!0},"Please choose..."),this.state.city.length>0?this.state.city.map(function(e){return y.a.createElement("option",{value:e.code,key:e.code},e.name)}):null)),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"",className:"control-label"},"Rate This Beer"),y.a.createElement(g.a,{className:"form-control isAntd",onChange:function(t){e.setState({rate:t})}})),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"description",className:"control-label"},"Description"),y.a.createElement("textarea",{id:"description",className:"form-control",rows:"5",style:{height:"unset"},defaultValue:this.state.description,onChange:function(t){e.setState({description:t.target.value})}})),y.a.createElement(h.a,{type:"primary",onClick:this.addBeer},"Submit")),y.a.createElement(v.a,{title:"Basic Modal",visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel},y.a.createElement("form",{action:"",onSubmit:function(e){e.preventDefault()}},y.a.createElement("div",{className:"form-wrapper"},y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"brewery-input-name"},"Name of the brewery"),y.a.createElement("input",{type:"text",className:"form-control",id:"brewery-input-name",placeholder:"Name of the brewery",onChange:function(t){e.setState({breweryName:t.target.value})}})),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"brewery-inputCountry"},"Country"),y.a.createElement("select",{id:"brewery-inputCountry",className:"form-control",onChange:function(t){var a=e.findByCode(e.state.country,t.target.value);e.getStateInfo(t.target.value),e.setState({breweryCountry:a})}},y.a.createElement("option",{defaultValue:!0},"Please choose..."),this.state.country.length>0?this.state.country.map(function(e){return y.a.createElement("option",{value:e.code,key:e.code},e.name)}):null)),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"brewery-inputState"},"State"),y.a.createElement("select",{id:"brewery-inputState",className:"form-control",onChange:function(t){var a=e.findByCode(e.state.state,t.target.value);e.getCityInfo(t.target.value),e.setState({breweryState:a})}},y.a.createElement("option",{defaultValue:!0},"Please choose..."),this.state.state.length>0?this.state.state.map(function(e){return y.a.createElement("option",{value:e.code,key:e.code},e.name)}):null)),y.a.createElement("div",{className:"form-group"},y.a.createElement("label",{htmlFor:"brewery-inputCity"},"City"),y.a.createElement("select",{id:"brewery-inputCity",className:"form-control",onChange:function(t){console.log(t.target.value);var a=e.findByCode(e.state.city,t.target.value);console.log(a),e.setState({breweryCity:a})}},y.a.createElement("option",{defaultValue:!0},"Please choose..."),this.state.city.length>0?this.state.city.map(function(e){return y.a.createElement("option",{value:e.code,key:e.code},e.name)}):null))))))}},{key:"componentDidMount",value:function(){this.getCountryData(),console.log(this.props)}}]),t}(d.Component);t.default=Object(C.b)(Object(C.c)(E.d,{name:"getBreweryQuery"}),Object(C.c)(w.b,{name:"CREATE_BEER"}),Object(C.c)(w.c,{name:"CREATE_BREWERY"}))(N)}}]);
//# sourceMappingURL=6.4dbac3e9.chunk.js.map